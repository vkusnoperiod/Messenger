# Мессенджер для социальной сети сотрудников

Этот проект представляет собой многопоточный бэкенд для мессенджера в социальной сети между сотрудниками, реализованный с использованием микросервисной архитектуры. Основной стек технологий включает **FastAPI**, **RabbitMQ** и **SQLite** для обработки и хранения данных.

## Структура проекта

Проект состоит из следующих микросервисов:

- **API Gateway**: единая точка входа для запросов от фронтенда. Маршрутизирует запросы к соответствующим микросервисам.
- **User Service**: управление пользователями, включая регистрацию, аутентификацию и управление профилями.
- **Messaging Service**: отправка и прием сообщений между пользователями.
- **Notification Service**: отправка уведомлений пользователям о новых сообщениях и других событиях.
- **History Service**: хранение истории сообщений и предоставление доступа к ней.

## Технологии

- **FastAPI**: для создания REST API для каждого микросервиса.
- **RabbitMQ**: для асинхронной обработки сообщений между сервисами.
- **SQLite**: для хранения данных (можно заменить на другую базу данных).
- **Docker**: для контейнеризации каждого микросервиса (опционально).

## Установка и запуск

### Предварительные требования

- Установленный [Python 3.8+](https://www.python.org/downloads/)
- Установленный [RabbitMQ](https://www.rabbitmq.com/download.html)
- (Опционально) Установленный [Docker](https://docs.docker.com/get-docker/), если проект будет развертываться в контейнерах

### Локальный запуск

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/yourusername/yourprojectname.git
    cd yourprojectname
    ```

2. **Установите зависимости для каждого микросервиса:**

    Перейдите в каждую папку микросервиса (например, `api_gateway`, `user_service`) и установите зависимости:

    ```bash
    cd api_gateway
    pip install -r requirements.txt
    ```

3. **Запустите RabbitMQ**:

    Убедитесь, что RabbitMQ запущен. По умолчанию он работает на `localhost:5672`.

4. **Запустите каждый микросервис**:

    В каждом каталоге микросервиса выполните команду для запуска FastAPI:

    ```bash
    uvicorn main:app --host 0.0.0.0 --port <PORT>
    ```

    Например:

    - API Gateway: `uvicorn main:app --host 0.0.0.0 --port 8000`
    - User Service: `uvicorn main:app --host 0.0.0.0 --port 8001`
    - Messaging Service: `uvicorn main:app --host 0.0.0.0 --port 8002`
    - Notification Service: `uvicorn main:app --host 0.0.0.0 --port 8003`
    - History Service: `uvicorn main:app --host 0.0.0.0 --port 8004`

### Запуск с помощью Docker

1. **Сборка и запуск контейнеров**:

    В корневом каталоге проекта выполните команды:

    ```bash
    docker-compose build
    docker-compose up
    ```

    Docker Compose настроит контейнеры для каждого микросервиса и RabbitMQ. После запуска они будут доступны по соответствующим портам.

## Использование API

Для взаимодействия с API можно использовать такие инструменты, как **curl**, **Postman** или встроенную документацию **Swagger** от FastAPI, которая доступна по адресу `/docs` для каждого сервиса. Например:

- [API Gateway Swagger](http://localhost:8000/docs)
- [User Service Swagger](http://localhost:8001/docs)
- [Messaging Service Swagger](http://localhost:8002/docs)
- [Notification Service Swagger](http://localhost:8003/docs)
- [History Service Swagger](http://localhost:8004/docs)

## Основные эндпоинты

### API Gateway

- `POST /register` - регистрация нового пользователя
- `POST /send_message` - отправка сообщения

### User Service

- `POST /register` - регистрация нового пользователя
- `GET /user/{username}` - получение профиля пользователя

### Messaging Service

- `POST /send_message` - отправка сообщения

### Notification Service

- Обрабатывает сообщения из очереди RabbitMQ и отправляет уведомления

### History Service

- `GET /history/{user_id}` - получение истории сообщений пользователя

## Разработка и тестирование

1. **Создание веток**: используйте ветки для разработки новых функций.
2. **Pull Requests**: создавайте pull request для обзора и слияния изменений.
3. **Тесты**: добавьте тесты для каждого микросервиса в папке `tests`. Запуск тестов:

    ```bash
    pytest tests/
    ```

## Поддержка и авторы

Этот проект поддерживается разработчиками проекта. Если у вас есть вопросы или предложения, создайте новый **Issue** в репозитории или отправьте **Pull Request**.

## Лицензия

Этот проект распространяется по лицензии MIT. Подробности можно найти в файле LICENSE.
